import{r as l,b as m,B as d,j as e}from"./index-CvOK6pca.js";import{M as w,N as F,t as D,l as k,O as P,P as C,Q as U}from"./index-B8cdnCNl.js";import{g as A}from"./helpers-CaOlnEck.js";const _=()=>{const[h,x]=l.useState([]),[f,n]=l.useState(!0),[g,u]=l.useState({});l.useEffect(()=>{i()},[]);const i=async()=>{try{n(!0);const{data:s}=await m.get("/documents/employee");x(s||[]),n(!1)}catch(s){console.error("Error fetching documents:",s),d.error("Failed to load documents. Please try again later."),x([]),n(!1)}},y=async(s,a)=>{if(a){if(a.size>5*1024*1024){d.error("File size exceeds 5MB limit");return}if(!a.type.startsWith("image/")&&a.type!=="application/pdf"){d.error("Only image or PDF files are allowed");return}try{u(c=>({...c,[s]:!0}));const t=new FormData;t.append("document",a),t.append("documentType",s),await m.post("/documents/upload",t,{headers:{"Content-Type":"multipart/form-data"}}),d.success("Document uploaded successfully"),i()}catch(t){console.error("Error uploading document:",t),d.error("Failed to upload document")}finally{u(t=>({...t,[s]:!1}))}}},j=async s=>{if(window.confirm("Are you sure you want to delete this document?"))try{await m.delete(`/documents/${s}`),d.success("Document deleted successfully"),i()}catch(a){console.error("Error deleting document:",a),d.error("Failed to delete document")}},N=s=>h.find(a=>a.documentType===s),b=s=>{switch(s){case"approved":return e.jsxs("span",{className:"flex items-center text-sm text-green-600",children:[e.jsx(U,{className:"mr-1"})," Approved"]});case"rejected":return e.jsxs("span",{className:"flex items-center text-sm text-red-600",children:[e.jsx(C,{className:"mr-1"})," Rejected"]});default:return e.jsxs("span",{className:"flex items-center text-sm text-yellow-600",children:[e.jsx(P,{className:"mr-1"})," Pending"]})}},o=(s,a,t,c=!0)=>{const r=N(t),p=g[t];return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:s}),r&&b(r.status)]}),e.jsx("p",{className:"text-gray-600 mb-4",children:a}),r?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[r.fileType.includes("pdf")?e.jsx(w,{className:"text-red-500 text-xl mr-2"}):e.jsx(F,{className:"text-blue-500 text-xl mr-2"}),e.jsx("span",{className:"text-sm text-gray-700 truncate max-w-xs",children:r.fileName})]}),e.jsxs("div",{className:"flex",children:[e.jsx("a",{href:A(r.filePath),target:"_blank",rel:"noopener noreferrer",className:"mr-2 px-2 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600",children:"View"}),e.jsx("button",{onClick:()=>j(r._id),className:"px-2 py-1 text-xs bg-red-500 text-white rounded hover:bg-red-600",children:e.jsx(D,{})})]})]}),r.remarks&&e.jsxs("div",{className:"text-sm italic text-gray-500 mt-1",children:["HR Note: ",r.remarks]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Uploaded: ",new Date(r.uploadDate).toLocaleDateString()]})]}):e.jsx("div",{children:e.jsx("label",{className:"block mt-4",children:e.jsxs("div",{className:`flex items-center justify-center px-6 py-4 border-2 border-dashed rounded-md ${c?"border-red-300 bg-red-50":"border-gray-300 bg-gray-50"} cursor-pointer hover:bg-gray-100`,children:[e.jsx(k,{className:"mr-2 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-500",children:p?"Uploading...":`Select ${c?"required":""} ${s} file`}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*,.pdf",disabled:p,onChange:v=>y(t,v.target.files[0])})]})})})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"pb-5 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Personal Documents"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Upload your personal documents for HR verification. Supported formats: JPG, PNG, PDF (Max 5MB)"})]}),f?e.jsxs("div",{className:"text-center py-10",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-indigo-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading your documents..."})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o("Aadhaar Card (Front)","Upload the front side of your Aadhaar card","aadhar_front",!0),o("Aadhaar Card (Back)","Upload the back side of your Aadhaar card","aadhar_back",!0),o("PAN Card","Upload your PAN card","pan_card",!0),o("Bank Passbook/Statement","First page of passbook or statement with account details","passbook",!0),o("Certificates","Any degree or professional certificates (Optional)","certificate",!1)]})]})};export{_ as default};
