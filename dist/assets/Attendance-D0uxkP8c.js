import{r as d,j as e,b as f,B as b}from"./index-CvOK6pca.js";import{G as w,k as v}from"./index-B8cdnCNl.js";import{f as y}from"./format-BJRZ2Kak.js";import{P as S}from"./Pagination-CcI0oFiK.js";import"./en-US-D8UQXs-H.js";const k=({onAttendanceMarked:c})=>{const o=y(new Date,"yyyy-MM-dd"),[s,m]=d.useState({date:o,status:"Present",notes:""}),[i,n]=d.useState(!1),[u,a]=d.useState(""),l=x=>{const{name:t,value:r}=x.target;m(p=>({...p,[t]:r}))},g=()=>s.date?s.status?(a(""),!0):(a("Please select attendance status"),!1):(a("Please select a date"),!1),h=async x=>{var t,r;if(x.preventDefault(),!!g()){n(!0);try{await f.post("/attendance",s),b.success("Attendance marked successfully!"),m({date:o,status:"Present",notes:""}),c&&c()}catch(p){const N=((r=(t=p.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to mark attendance";b.error(N)}finally{n(!1)}}};return e.jsxs("div",{className:"bg-white rounded-lg",children:[u&&e.jsx("div",{className:"p-3 mb-4 text-white bg-red-500 rounded",children:u}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date",className:"block mb-1 font-medium text-gray-700",children:"Date*"}),e.jsx("input",{type:"date",id:"date",name:"date",value:s.date,onChange:l,max:o,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-indigo-200",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block mb-1 font-medium text-gray-700",children:"Status*"}),e.jsxs("select",{id:"status",name:"status",value:s.status,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-indigo-200",required:!0,children:[e.jsx("option",{value:"Present",children:"Present"}),e.jsx("option",{value:"Absent",children:"Absent"}),e.jsx("option",{value:"Half-day",children:"Half-day"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block mb-1 font-medium text-gray-700",children:"Notes (Optional)"}),e.jsx("textarea",{id:"notes",name:"notes",value:s.notes,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-indigo-200",rows:"3",placeholder:"Add any specific comments or information here..."})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:i,className:`w-full px-4 py-2 font-medium text-white rounded ${i?"bg-gray-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"}`,children:i?"Submitting...":"Submit Attendance"})})]})]})},M=()=>{const[c,j]=d.useState([]),[o,s]=d.useState(!0),[m,i]=d.useState(""),[n,u]=d.useState(null),[a,l]=d.useState({page:1,limit:10,total:0,pages:0});d.useEffect(()=>{(async()=>{try{s(!0);const r=await f.get("/employees/profile");u(r.data),await g()}catch{i("Failed to fetch attendance records"),s(!1)}})()},[a.page]);const g=async()=>{try{const{data:t}=await f.get(`/attendance/me?page=${a.page}&limit=${a.limit}`);j(t.attendance),l(t.pagination),s(!1)}catch{i("Failed to fetch attendance records"),s(!1)}},h=async()=>{try{l(t=>({...t,page:1})),await g()}catch{i("Failed to refresh attendance records")}},x=t=>{switch(t){case"Present":return"bg-green-100 text-green-800";case"Absent":return"bg-red-100 text-red-800";case"Half-day":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};return o?e.jsx("div",{className:"flex justify-center p-8",children:"Loading attendance records..."}):e.jsxs("div",{className:"space-y-8",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"My Attendance"}),m&&e.jsx("div",{className:"p-3 mb-4 text-white bg-red-500 rounded",children:m}),n&&e.jsx("div",{className:"p-4 bg-white rounded-lg shadow mb-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 rounded-full bg-indigo-100",children:e.jsx(w,{className:"text-indigo-600 text-xl"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium",children:[n.firstName," ",n.lastName]}),e.jsxs("p",{className:"text-gray-600",children:["Employee ID: ",n._id]}),e.jsxs("p",{className:"text-gray-600",children:[n.department," â€¢ ",n.position]})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Mark Attendance"}),e.jsx(k,{onAttendanceMarked:h})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Attendance History"})}),c.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(v,{className:"mx-auto text-gray-300",size:40}),e.jsx("p",{className:"mt-2",children:"No attendance records found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Check-in Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Notes"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:y(new Date(t.date),"MMM dd, yyyy")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${x(t.status)}`,children:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.checkInTime?y(new Date(t.checkInTime),"hh:mm a"):"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",children:t.notes||"-"})})]},t._id))})]})}),e.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200",children:a.pages>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing page ",a.page," of ",a.pages]}),e.jsx(S,{currentPage:a.page,totalPages:a.pages,onPageChange:t=>l(r=>({...r,page:t}))})]})})]})]})};export{M as default};
